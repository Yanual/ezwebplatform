<html>
<head>
<title>EzWeb Platform</title>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" type="text/css" media="screen,projection" href="css/ezweb.css" />
<link rel="stylesheet" type="text/css" href="css/dragboard.css">
<link rel="stylesheet" type="text/css" href="css/ezweb.css">
<link rel="shortcut icon" type="image/x-icon" href="css/favicon.ico" />

<script type="text/javascript" language="javascript" src="lib/prototype/prototype.js"></script>
<script language="JavaScript" src="common/uris.js"></script>
<script language="JavaScript" src="common/modules.js"></script>
<script language="JavaScript" src="persistenceEngine/PersistenceEngine.js"></script>

<script language="JavaScript" src="gadgetModel/XHtml.js"></script>
<script language="JavaScript" src="gadgetModel/Template.js"></script>
<script language="JavaScript" src="gadgetModel/Gadget.js"></script>

<script language="JavaScript" src="opManager/OpManager.js"></script>
<script language="JavaScript" src="varManager/VariableGadget.js"></script>
<script language="JavaScript" src="varManager/VariablePlatform.js"></script>
<script language="JavaScript" src="varManager/varManager.js"></script>

<script language="JavaScript" src="showcase/showcase.js"></script>
<script language="JavaScript" src="showcase/util.js"></script>

<script type="text/javascript" language="javascript" src="lib/scriptaculous/scriptaculous.js"></script>
<script type="text/javascript" language="javascript" src="dragboard/dragboard.js"></script>
<script type="text/javascript" language="javascript" src="dragboard/UserPref.js"></script>

<script language="JavaScript" src="wiring/connectable.js"></script>
<script language="JavaScript" src="wiring/wiring.js"></script>
<script language="JavaScript" src="wiring/wiringInterface.js"></script>

		<link rel="stylesheet" type="text/css" href="css/catalogue.css" />
		<script language="JavaScript" src="lib/prototype/prototype.improvements.js"></script>
		<script language="JavaScript" src="lib/helpballoon/HelpBalloon.js"></script>
		<script language="JavaScript" src="catalogue/UIUtils.js"></script>
		<script language="JavaScript" src="catalogue/Catalogue.js"></script>
		<script language="JavaScript" src="catalogue/Resource.js"></script>
		<script language="JavaScript" src="catalogue/Tagger.js"></script>
		<script language="JavaScript" src="catalogue/Tag.js"></script>
		<script language="JavaScript" src="catalogue/HashTable.js"></script>
		<script type="text/javascript">
			window.onresize = UIUtils.setResourcesWidth;
		</script>

<!-- Initialization code -->
<script language="JavaScript">

	function showInterface(element) {
		var elements = ["wiring_container", "showcase_container", "dragboard_container"];

		for (var i = 0; i < elements.length; i++)
			$(elements[i]).style.zIndex = 1;

		$(element).style.zIndex = 2;
	}

	function show_showcase() {
	        opManager.repaintCatalogue("http://europa.ls.fi.upm.es:8000/user/admin/catalogue/resources");
		showInterface('showcase_container');
		UIUtils.setResourcesWidth();
		document.getElementById('simple_search_text').focus();
	}
	
	function show_dragboard() {
		showInterface('dragboard_container');
	}
	
	function show_wiring() {
		wI.renewInterface(WiringFactory.getInstance(),$('selectCanal'),$('wGadgets'),$('wCanales'));
		//wI.renewInterface();
		showInterface('wiring_container');
	}
		
	// Platform initialization
	function environmentLoadedCallback() {
		DragboardFactory.getInstance().repaint();
		wI = new wiringInterface();
	}
	var wI;
	var opManager = OpManagerFactory.getInstance();
	opManager.loadEnviroment();
</script>


</head>

<body>

<!-- HEADER -->
<table id="header">
	<tr>
		<td><img src="http://europa.ls.fi.upm.es:8000/ezweb/Ezweb.png" style="width: 120px; height: 60px" alt="EzWeb Logo"></td>
		<td valign="top" style="text-align: right"><div id="toolbar">
				<a href="javascript:;" onclick="show_showcase();">My Gadgets</a> | <a href="javascript:;" onclick="show_wiring();">My Pipes</a>
		</div></td>
	</tr>
</table>

<div id="wrapper">
  <!-- DRAGBOARD LAYER -->
  <div id="dragboard_container" class="container">
     <table class="container_header">
     <tr>
       <td style="text-align:left"><h3>My Instances</h3></td>
       <td style="text-align:right"></td>
     </tr>
     </table>
     <!-- DRAGBOARD VIEW -->
     <div id="dragboard">
     </div><!-- DRAGBOARD VIEW -->
  </div>

  <!-- SHOWCASE LAYER -->
  <div id="showcase_container" class="container">
    <table class="container_header">
    <tr>
       <td style="text-align:left"><h3>My Gadgets</h3></td>
       <td style="text-align:right" valign="top"><a href="javascript:;" onclick="show_dragboard();">hide</a></td>
    </tr>
    </table>
    <!-- SHOWCASE VIEW -->
		<div id="showcase" class="main" onresize="UIUtils.setResourcesWidth();">
			<div id="head" class="head">
				<div id="new_resource" class="search">
				<div class="simple_search">
				        <form action="#" onSubmit="UIUtils.addResource('http://europa.ls.fi.upm.es:8000/user/admin/catalogue/resources/', 'template_uri', this.template_uri.value)">
					<label for="new_resource_text">URL del Template: </label>
					<input id="new_resource_text" name="template_uri" type="text" />
					<button>Crear recurso</button>
					</form>
				</div>
				</div>
				<div id="search" class="search">
					<form onsubmit="return false;">
						<div id="advanced_search_top" class="advanced_search_top" style="display:none;">
							<span>Opciones avanzadas</span>
						</div>
						<div id="advanced_search_bottom" class="advanced_search_bottom" style="display:none;">
							<label for="advanced_search_text">B&uacute;squeda:</label>
							<input type="text" id="advanced_search_text" name="advanced_search_text" class="text" autocomplete="on"></input>
							<button onclick="UIUtils.evaluarFormulario(this.form);">Buscar</button><br/>
							<a href="#" onclick="UIUtils.SlideAdvancedSearchOutOfView('advanced_search_top');">Mostrar b&uacute;squeda simple</a>
						</div>
						<div id="simple_search" class="simple_search">
							<label for="simple_search_text">B&uacute;squeda:</label>
							<input type="text" id="simple_search_text" name="simple_search_text" class="text" autocomplete="on"></input>
							<button onclick="UIUtils.searchByTag('http://europa.ls.fi.upm.es:8000/user/admin/catalogue/resources/', this.form.simple_search_text.value);">Buscar</button><br/>
							<a href="#" onclick="UIUtils.SlideAdvancedSearchIntoView('advanced_search_top');">Mostrar b&uacute;squeda avanzada</a>
						</div>
					</form>
				</div>
			</div>
			<div id="center" class="center">
				<div id="resources" class="resources"></div>
				<div id="info_resource" class="info_resource" style="display:none;"><div>
					<div class="top"></div>
					<div id="info_resource_content" class="content"></div>
					<div class="bottom"></div>
				</div></div>
				<div id="tab_info_resource" class="tab_info_resource">
					<a id="tab_info_resource_open" title="Mostrar informaci&oacute;n del recurso" href="javascript:UIUtils.openInfoResource();" onmouseover="UIUtils.changeImage('tab_info_resource_open_img', 'images/info_resource_open_selected.png');" onmouseout="UIUtils.changeImage('tab_info_resource_open_img', 'images/info_resource_open.png');">
						<img  id="tab_info_resource_open_img" src="images/info_resource_open.png"></img>
					</a>
					<a id="tab_info_resource_close" title="Ocultar informaci&oacute;n del recurso" href="javascript:UIUtils.closeInfoResource();" onmouseover="UIUtils.changeImage('tab_info_resource_close_img', 'images/info_resource_close_selected.png');" onmouseout="UIUtils.changeImage('tab_info_resource_close_img', 'images/info_resource_close.png');" style="display:none;">
						<img  id="tab_info_resource_close_img" src="images/info_resource_close.png"></img>
					</a>
				</div>
			</div>
		</div>
 <!-- SHOWCASE VIEW -->
  </div> <!-- SHOWCASE LAYER -->

  <!-- WIRING LAYER -->
  <div id="wiring_container" class="container">
	<table class="container_header">
	<tr>
		<td style="text-align:left"><h3>My Pipes</h3></td>
		<td style="text-align:right" valign="top"><a href="javascript:;" onclick="show_dragboard();">hide</a></td>
	</tr>
	</table>
	<div style="position:relative; width:100%; height:93%; overflow:auto" id="wiring">
	<!-- WIRING VIEW -->
		<div class = "left">
			<input id = "gadget9" type = text value = "id gadget...">
			<input id = "event9"  type = text value = "name event...">
			<input id = "value9"  type = text value = "value...">
			<input type = button  value= "send event" onclick = "opManager.sendEvent($F($('gadget9')),$F($('event9')), $F($('value9')));wI.renewChannel(w,$F($('selectCanal')),$('slotsConnection'),$('eventsConnection'))">
			<input type = button value = "serializa" id = "serializa" onClick ="alert(WiringFactory.getInstance().serialize())">
		</div>
		<div class = "wContainer">
			<fieldset id = "one">
				<div id = "selector">
					<em>Seleccione un canal:</em>
					<select id = "selectCanal"  onChange = "wI.renewChannel(w,$F($('selectCanal')),$('slotsConnection'),$('eventsConnection'))">
						<option value = "" selected>----</option>
					</select>
				</div>
				<div id = "view">
					<input id = "valor" type = "text" value = "">
					<input id = "addChannel" type=image src=wiring/add.png title="Create Channel" alt= "create channel"
					    onclick = "wI.addChannel(w,$('selectCanal'),$('wCanales'),$('slotsConnection'),$('eventsConnection'))">
					<input id = "deleteChannel" type=image src=wiring/delete.png title="Delete Channel" alt= "Delete Channel"
					    onclick = "wI.deleteChannel(w,$('selectCanal').value,$('selectCanal'),$('wCanales'),$('slotsConnection'),$('eventsConnection'))">
				</div>
				<div id = "tab_one">
					<table class = "header">
						<tr><td> </td><td>Input connection</td></tr>
					</table>
					<div class = "contents">
        					<table class = "bodier" id = "eventsConnection">
						</table>
					</div>
				</div>
				<div id = "tab_two">
					<table class = "header">
						<tr><td> </td><td>Output connection</td></tr>
					</table>
					<div class = "contents">
        					<table class = "bodier" id = "slotsConnection">
						</table>
					</div>
				</div>
			</fieldset>
			<fieldset id = "two">
				<div>
					<input id = "refreshbutton" type = image src = wiring/disk.png title = "Save data" alt = "Actualizar" onClick = "opManager.restaure()">	
				</div>
				<div id = "selector">
					<em>Seleccione un item:</em>
					<select id = "itemizer"  onChange = "wI.renewItem(w,$F($('itemizer')),$('slots'),$('events'))">
						<option value = "" selected>----</option>
						<optgroup id="wCanales">
							<option value = "" disabled>Canales</option>
							</optgroup>
						<optgroup id ="wGadgets">
							<option value = "" disabled>Gadgets</option>
						</optgroup>
					</select>
				</div>
				<div id = "tab_one">
					<table class = "header">
						<tr><td> </td><td>Outputs</td></tr>
					</table>
					<div class = "contents">
        					<table class = "bodier" id = "events">
						</table>
					</div>
				</div>
				<div id = "tab_two">
					<table class = "header">
						<tr><td> </td><td>Inputs</td></tr>
					</table>
					<div class = "contents">
        					<table class = "bodier" id = "slots">
						</table>
					</div>
				</div>
			</fieldset>
		</div>
    </div> <!-- WIRING VIEW -->
  </div> <!-- WIRING LAYER -->
</div>
</body>

</html>
